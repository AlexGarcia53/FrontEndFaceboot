<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../css/publicar.css">
  <link rel="stylesheet" href="../css/publicationHeader.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="../css/header.css">
  <script type="module" src="../components/modals/update.js"></script>
  <script type="module" src="../components/header/header.js"></script>
  <script type="module" src="../components/modals/addPublication.js"></script>

  <script src="../services/loadPublicaciones.js" defer></script>

  <script type="module" src="../services/firebase.js"> </script>

  <script type="module" src="../components/publicar/publicar.js"></script>
  <script type="module" src="../components/login/verificarToken.js"></script>
  <script type="module" src="../components/publicacion/publicacion.js"></script>
  <script type="module" src="../components/publicacion/publicationComment.js"></script>
  <script type="module" src="../components/publicacion/publicationContent.js"></script>
  <script type="module" src="../components/publicacion/publicationHeader.js"></script>
  <script type="module" src="../components/publicacion/commentPublication.js"></script>
  <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
  <title>Faceboot</title>
</head>

<body>
  <header>
    <header-comp></header-comp>
  </header>
  <update-comp></update-comp>

  <addpublication-comp></addpublication-comp>
  <publicar-comp></publicar-comp>
  <button onclick=recuperarPublicaciones()>Cargar otra</button>

  <div id="contenedor-publicaciones"></div>
  <script>
    // Conecta con el servidor de sockets
    const socket = io('http://localhost:3211');

    // Evento para eliminar un comentario
    socket.on('comentarioEliminado', (data) => {
      const comentarioId = data.idComentario;

      // Crea un evento personalizado para eliminar el comentario
      const eventoEliminarComentario = new CustomEvent('eliminarComentario', {
        detail: { comentarioId }
      });

      window.dispatchEvent(eventoEliminarComentario);
    });

    socket.on('comentarioAgregado', (data) => {
      const idPublicacion = data.idPublicacion;
      const eventoAgregarComentario = new CustomEvent('agregarComentario', {
        detail: { idPublicacion }
      });

      window.dispatchEvent(eventoAgregarComentario);
    });

    socket.on('comentarioEditado', (data) => {
      const idComentario = data.idComentario;
      const nuevoTexto = data.nuevoTexto;
      const nuevaImagen = data.nuevaImagen;

      const eventoActualizarComentario = new CustomEvent('actualizarComentario', {
        detail: { idComentario, nuevoTexto, nuevaImagen }
      });

      window.dispatchEvent(eventoActualizarComentario);
    });

  </script>
</body>

</html>